@* Views/Shared/_BookFilter.cshtml *@
<div class="card mb-3">
    <div class="card-body">
        <form id="bookFilterForm" class="row g-3">

            <div class="col-md-4">
                <label class="form-label">Title</label>
                <input type="text" class="form-control" id="filterTitle" placeholder="Search title...">
            </div>

            <div class="col-md-3">
                <label class="form-label">ISBN</label>
                <input type="text" class="form-control" id="filterISBN" placeholder="Search ISBN...">
            </div>

            <div class="col-md-3">
                <label class="form-label">Author</label>
                <input type="text" class="form-control" id="filterAuthor" placeholder="Search author...">
            </div>

            <div class="col-md-2 d-flex align-items-end">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="filterAvailableOnly">
                    <label class="form-check-label">
                        Available Only
                    </label>
                </div>
            </div>

        </form>
    </div>
</div>

<script>
    // Trigger filter callback
    document.querySelectorAll('#bookFilterForm input').forEach(input => {
        input.addEventListener('input', function () {
            applyBookFilters();
        });
    });

    function applyBookFilters() {
        const table = $('#booksTable').DataTable();

        const title = document.getElementById('filterTitle').value.toLowerCase();
        const isbn = document.getElementById('filterISBN').value.toLowerCase();
        const author = document.getElementById('filterAuthor').value.toLowerCase();
        const availableOnly = document.getElementById('filterAvailableOnly').checked;

        table.rows().every(function () {
            const data = this.data();

            const matchesTitle = data[1].toLowerCase().includes(title);
            const matchesISBN = data[2].toLowerCase().includes(isbn);
            const matchesAuthor = data[3].toLowerCase().includes(author);
            const matchesAvail = !availableOnly || parseInt(data[5]) > 0;

            if (matchesTitle && matchesISBN && matchesAuthor && matchesAvail) {
                this.node().style.display = '';
            } else {
                this.node().style.display = 'none';
            }
        });
    }
</script>
